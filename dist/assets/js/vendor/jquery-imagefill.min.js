!function(t){t.fn.imagefill=function(i){var e=this,h=1,o=0,n=0,s=t.extend({},{runOnce:!1,target:"img",throttle:200},i),r=e.find(s.target).addClass("loading").css({position:"absolute"}),a=e.css("position");function u(){o=0,n=0,e.each(function(){h=t(this).find(s.target).width()/t(this).find(s.target).height();var i=t(this).outerWidth(),e=t(this).outerHeight();o+=t(this).outerHeight(),n+=t(this).outerWidth(),i/e<h?t(this).find(s.target).css({width:"auto",height:e,top:0,left:-(e*h-i)/2}):t(this).find(s.target).css({width:i,height:"auto",top:-(i/h-e)/2,left:0})})}function d(){var i=0,h=0;e.each(function(){h+=t(this).outerHeight(),i+=t(this).outerWidth()}),o===h&&n===i||u(),setTimeout(d,s.throttle)}return e.css({overflow:"hidden",position:"static"===a?"relative":a}),e.each(function(){o+=t(this).outerHeight(),n+=t(this).outerWidth()}),e.imagesLoaded().done(function(t){h=r.width()/r.height(),r.removeClass("loading"),u(),s.runOnce||d()}),this}}(jQuery);
